# https://docs.travis-ci.com/user/job-lifecycle
language: ruby
sudo: false

# https://docs.travis-ci.com/user/languages/ruby/
rvm:
  - 2.3

before_script:
  - cp config/database.yml.travis config/database.yml

before_install:
  - sudo apt-get install -y imagemagick libmagickwand-dev
  
addons:
  apt:
    update: true

install: true

script:
  - bundle install --deployment
  - RAILS_ENV=test SKIP_LARGE_UNNEEDED_IMPORTS=true SKIP_ZIP_CODE_IMPORTS=true travis_wait 120 bundle exec rake db:test:prepare test

after_failure:
  - cat /home/travis/build/myplaceonline/myplaceonline_rails/vendor/bundle/ruby/2.3.0/extensions/x86_64-linux/2.3.0/rmagick-3.0.0/mkmf.log
