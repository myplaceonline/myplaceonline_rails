<%= myp_datetime_field(f, :meal_time, "myplaceonline.meals.meal_time", obj.meal_time) %>
<%=
  render layout: "myplaceonline/childproperties", locals: {
    f: f,
    heading: t("myplaceonline.foods.heading"),
    childpropertiesname: :meal_foods,
    childproperties: obj.meal_foods,
    deletebutton: t("myplaceonline.foods.delete"),
    addbutton: t("myplaceonline.foods.add"),
    expanded: true,
    formjson: [
      {
        type: :renderpartial,
        name: :food_attributes,
        partial: "myplaceonline/select_or_create",
        heading: t("myplaceonline.foods.food"),
        objform: "foods/form",
        existingobjurl: "food_path",
        searchurl: "/foods.json?perpage=0",
        edit: false,
        allowinnerfoods: true,
        autofocus: true
      },
      {
        type: 'text',
        name: 'food_servings',
        placeholder: t("myplaceonline.foods.servings")
      }
    ]
  } do |child_fields, childproperty|
%>
  <%=
    render partial: "myplaceonline/select_or_create", locals: {
      f: child_fields,
      name: :food_attributes,
      existingobj: childproperty.food,
      heading: t("myplaceonline.foods.food"),
      objform: "foods/form",
      existingobjurl: "food_path",
      searchurl: "/foods.json?perpage=0",
      edit: edit,
      autofocus: false
    }
  %>
  <%= myp_text_field(child_fields, :food_servings, "myplaceonline.foods.servings", childproperty.food_servings) %>
<% end %>
<%=
  render layout: "myplaceonline/childproperties", locals: {
    f: f,
    heading: t("myplaceonline.drinks.heading"),
    childpropertiesname: :meal_drinks,
    childproperties: obj.meal_drinks,
    deletebutton: t("myplaceonline.drinks.delete"),
    addbutton: t("myplaceonline.drinks.add"),
    expanded: true,
    formjson: [
      {
        type: :renderpartial,
        name: :drink_attributes,
        partial: "myplaceonline/select_or_create",
        heading: t("myplaceonline.drinks.drink"),
        objform: "drinks/form",
        existingobjurl: "drink_path",
        searchurl: "/drinks.json?perpage=0",
        edit: false,
        autofocus: true
      },
      {
        type: 'text',
        name: 'drink_servings',
        placeholder: t("myplaceonline.drinks.servings")
      }
    ]
  } do |child_fields, childproperty|
%>
  <%=
    render partial: "myplaceonline/select_or_create", locals: {
      f: child_fields,
      name: :drink_attributes,
      existingobj: childproperty.drink,
      heading: t("myplaceonline.drinks.drink"),
      objform: "drinks/form",
      existingobjurl: "drink_path",
      searchurl: "/drinks.json?perpage=0",
      edit: edit,
      autofocus: false
    }
  %>
  <%= myp_text_field(child_fields, :drink_servings, "myplaceonline.drinks.servings", childproperty.drink_servings) %>
<% end %>
<%=
  render layout: "myplaceonline/childproperties", locals: {
    f: f,
    heading: t("myplaceonline.vitamins.heading"),
    childpropertiesname: :meal_vitamins,
    childproperties: obj.meal_vitamins,
    deletebutton: t("myplaceonline.vitamins.delete"),
    addbutton: t("myplaceonline.vitamins.add"),
    expanded: true,
    formjson: [
      {
        type: :renderpartial,
        name: :vitamin_attributes,
        partial: "myplaceonline/select_or_create",
        heading: t("myplaceonline.vitamins.vitamin"),
        objform: "vitamins/form",
        existingobjurl: "vitamin_path",
        searchurl: "/vitamins.json?perpage=0",
        edit: false,
        allowinnervitamins: true,
        autofocus: true
      }
    ]
  } do |child_fields, childproperty|
%>
  <%=
    render partial: "myplaceonline/select_or_create", locals: {
      f: child_fields,
      name: :vitamin_attributes,
      existingobj: childproperty.vitamin,
      heading: t("myplaceonline.vitamins.vitamin"),
      objform: "vitamins/form",
      existingobjurl: "vitamin_path",
      searchurl: "/vitamins.json?perpage=0",
      edit: edit,
      autofocus: false
    }
  %>
<% end %>
<%= myp_text_field(f, :price, "myplaceonline.meals.price", obj.price) %>
<%= myp_text_field(f, :calories, "myplaceonline.meals.calories", obj.calories) %>
<%=
  input_field(
    form: f,
    type: Myp::FIELD_TEXT_AREA,
    name: :notes,
    value: obj.notes,
    placeholder: "myplaceonline.general.notes",
    collapsed: obj.notes.blank?,
    placeholder_prefix: Myp.instance_to_category_human_readable(obj).singularize,
  )
%>
<%=
  render partial: "myplaceonline/select_or_create", locals: {
    f: f,
    name: :location,
    existingobj: obj.location,
    heading: t("myplaceonline.meals.location"),
    objform: "locations/form",
    existingobjurl: "location_path",
    searchurl: "/locations.json?perpage=0",
    edit: edit,
    autofocus: false
  }
%>
